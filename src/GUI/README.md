# PCB焊点检测系统 - Web GUI

## 系统概述

这是一个基于Web的PCB焊点检测系统图形用户界面，使用Flask作为后端框架，提供现代化的HTML5前端界面。系统集成了预处理、训练、检测等完整的深度学习工作流。

## 功能特性

### 1. 预处理模块
- **参数配置**: 在界面中直接修改图像resize尺寸
- **实时更新**: 配置即时生效到preprocessor.py文件
- **一键执行**: 点击按钮即可运行预处理脚本

### 2. 训练模块
- **数据集指导**: 提供YOLO和UNet++数据集标准结构指导
- **路径配置**: 图形化配置训练路径参数
- **训练控制**: 一键启动训练任务
- **实时监控**: 训练日志实时显示

### 3. 图片上传
- **拖拽上传**: 支持拖拽文件到上传区域
- **批量上传**: 支持多文件同时上传
- **格式检验**: 自动检查图片格式有效性
- **存储管理**: 自动保存到data/users目录

### 4. 检测模块
- **双模型支持**: 同时支持YOLO和UNet++模型
- **结果展示**: 图像化展示检测结果
- **结果管理**: 自动刷新和管理检测结果

### 5. 日志系统
- **实时日志**: 所有操作的实时日志记录
- **日志分类**: 按级别分类显示(INFO, ERROR, WARNING, SCRIPT)
- **自动滚动**: 支持自动滚动到最新日志
- **日志清理**: 支持手动清空日志

## 技术架构

### 后端技术栈
- **Flask**: Web框架
- **Python**: 主要编程语言
- **subprocess**: 脚本执行管理
- **threading**: 异步任务处理

### 前端技术栈
- **HTML5**: 标准HTML结构
- **CSS3**: 现代化样式设计
- **JavaScript**: 交互逻辑和API调用
- **Font Awesome**: 图标库

## 安装和使用

### 1. 环境准备
```bash
# 安装依赖
pip install flask werkzeug

# 确保其他项目依赖已安装
pip install -r requirements.txt
```

### 2. 启动系统
```bash
cd src/GUI
python app.py
```

### 3. 访问界面
打开浏览器访问: `http://localhost:5000`

## 界面功能说明

### 预处理区域
1. **图像尺寸设置**: 调整新尺寸值 (64-2048, 32的倍数)
2. **更新配置**: 将新配置写入preprocessor.py
3. **开始预处理**: 执行预处理脚本

### 训练数据区域
1. **数据集结构指导**: 
   - 点击"YOLO格式"查看YOLO数据集结构
   - 点击"UNet++格式"查看LabelMe数据集结构
2. **路径配置**: 设置图片目录、标注目录、模型保存路径
3. **开始训练**: 启动训练任务

### 图片上传区域
1. **上传方式**: 拖拽或点击选择
2. **文件列表**: 显示已上传的文件
3. **自动保存**: 文件自动保存到data/users

### 检测区域
1. **YOLO检测**: 使用YOLO模型进行目标检测
2. **UNet++检测**: 使用UNet++模型进行语义分割
3. **结果展示**: 自动显示检测结果图像

### 日志区域
1. **实时显示**: 所有操作的实时日志
2. **日志控制**: 清空日志、切换自动滚动
3. **颜色编码**: 不同级别的日志用不同颜色显示

## API接口

### 配置接口
- `GET /api/config/preprocessing` - 获取预处理配置
- `POST /api/config/preprocessing` - 更新预处理配置
- `GET /api/config/training` - 获取训练配置
- `POST /api/config/training` - 更新训练配置

### 执行接口
- `POST /api/run/preprocessing` - 运行预处理
- `POST /api/run/training` - 运行训练
- `POST /api/run/detection` - 运行检测

### 文件接口
- `POST /api/upload/image` - 上传图片
- `POST /api/upload/folder` - 上传文件夹信息
- `GET /api/results/<model_type>` - 获取检测结果
- `GET /api/results/<model_type>/<filename>` - 获取结果文件

### 系统接口
- `GET /api/logs` - 获取系统日志
- `GET /api/status/<task_id>` - 获取任务状态

## 数据集结构指导

### YOLO数据集结构
```
dataset/
├── images/
│   ├── train/          # 训练图片
│   └── val/            # 验证图片
├── labels/
│   ├── train/          # 训练标签(.txt文件)
│   └── val/            # 验证标签(.txt文件)
└── data.yaml           # 数据集配置文件
```

### UNet++数据集结构
```
dataset/
├── jpg/                # 原始图片文件(.jpg)
├── json/               # LabelMe标注文件(.json)
└── processed/          # 预处理后的图片(可选)
```

## 安全特性

1. **文件验证**: 严格的文件类型检查
2. **路径安全**: 防止路径遍历攻击
3. **大小限制**: 文件上传大小限制(500MB)
4. **错误处理**: 完善的错误捕获和处理

## 扩展功能

### 报告生成与实时监测
界面中已预留了报告生成和实时监测的空间，可以后续扩展以下功能：
- 自动生成检测报告
- 实时监测系统状态
- 性能分析和统计
- 批量处理结果汇总

## 浏览器兼容性

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 注意事项

1. **端口占用**: 确保5000端口未被占用
2. **权限设置**: 确保Python脚本有执行权限
3. **路径配置**: 确保所有路径配置正确
4. **模型文件**: 确保训练好的模型文件存在

## 故障排除

### 常见问题
1. **模块导入错误**: 检查Python路径和依赖安装
2. **文件权限错误**: 检查文件和目录权限
3. **端口冲突**: 更改app.py中的端口号
4. **脚本执行失败**: 检查脚本路径和Python环境

### 日志查看
所有操作和错误都会记录在系统日志中，可以通过界面查看详细信息。

## 开发者信息

这个Web GUI系统是PCB焊点检测项目的用户友好界面，集成了完整的深度学习工作流，为用户提供了便捷的操作体验。
